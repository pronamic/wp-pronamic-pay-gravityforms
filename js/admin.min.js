!function(c){function n(t){var a=this,r=c(t),s={},o=(s.feed=r.find("#gf_ideal_feed"),s.gravityForm=r.find("#gf_ideal_gravity_form"),s.fieldSelectFields=r.find("select.field-select"),s.subscriptionAmountType=r.find('input[name="_pronamic_pay_gf_subscription_amount_type"]'),s.subscriptionAmountField=r.find("#pronamic_pay_gf_subscription_amount_field"),s.subscriptionIntervalType=r.find('input[name="_pronamic_pay_gf_subscription_interval_type"]'),s.subscriptionInterval=r.find("#pronamic_pay_gf_subscription_interval"),s.subscriptionIntervalPeriod=r.find("#pronamic_pay_gf_subscription_interval_period"),s.subscriptionIntervalDateType=r.find('input[name="_pronamic_pay_gf_subscription_interval_date_type"]'),s.subscriptionIntervalDate=r.find("#pronamic_pay_gf_subscription_interval_date"),s.subscriptionIntervalDateDay=r.find("#pronamic_pay_gf_subscription_interval_date_day"),s.subscriptionIntervalDateMonth=r.find("#pronamic_pay_gf_subscription_interval_date_month"),s.subscriptionIntervalField=r.find("#pronamic_pay_gf_subscription_interval_field"),s.subscriptionFrequencyType=r.find('input[name="_pronamic_pay_gf_subscription_frequency_type"]'),s.subscriptionNumberPeriods=r.find("#pronamic_pay_gf_subscription_number_periods"),s.subscriptionFrequencyField=r.find("#pronamic_pay_gf_subscription_frequency_field"),s.subscriptionTrialEnabled=r.find("#pronamic_pay_gf_subscription_trial_enabled"),JSON.parse(s.feed.val())),p=JSON.parse(s.gravityForm.val());this.getFieldsByType=function(i){var e=[];if(p)for(var n=0;n<p.fields.length;n++)0<=c.inArray(p.fields[n].type,i)&&e.push(p.fields[n]);return e},this.getInputs=function(){var n=[];return p&&c.each(p.fields,function(i,e){e.inputs?c.each(e.inputs,function(i,e){n.push(e)}):e.displayOnly||n.push(e)}),n},this.updateSubscriptionFields=function(){var n;p&&(s.subscriptionAmountField.empty(),s.subscriptionIntervalField.empty(),s.subscriptionFrequencyField.empty(),n=[],p&&c.each(p.fields,function(i,e){"product"===e.type&&n.push(e)}),r=c(s.subscriptionAmountField),c("<option>").appendTo(r),c.each(n,function(i,e){var n=e.adminLabel||e.label;c("<option>").attr("value",e.id).text(n).prop("selected",o.subscriptionAmountField==e.id).appendTo(r)}),s.subscriptionAmountType.on("change",function(){var i=s.subscriptionAmountType.filter(":checked").val(),e=(c(t).find(".pronamic-pay-gf-subscription-amount-settings").hide(),""===i?s.subscriptionAmountType.parents("tr").siblings().hide():(s.subscriptionAmountType.parents("tr").siblings().show(),(e=s.subscriptionAmountType.parents("table").find("tr")).removeClass("even"),e.filter(":visible:even").addClass("even")),c(t).find(".pronamic-pay-gf-subscription-amount-settings.amount-"+i));0<e.length&&e.show()}),s.subscriptionAmountType.trigger("change"),r=c(s.subscriptionIntervalField),c("<option>").appendTo(r),c.each(a.getInputs(),function(i,e){var n=e.adminLabel||e.label;c("<option>").attr("value",e.id).text(n).prop("selected",o.subscriptionIntervalField==e.id).appendTo(r)}),s.subscriptionIntervalType.on("change",function(){var i=s.subscriptionIntervalType.filter(":checked").val(),e=(c(t).find(".pronamic-pay-gf-subscription-interval-settings").hide(),c(t).find(".pronamic-pay-gf-subscription-interval-settings.interval-"+i));"fixed"!==i&&(s.subscriptionIntervalPeriod.val("D"),s.subscriptionIntervalPeriod.trigger("change")),0<e.length&&e.show()}),s.subscriptionIntervalDateType.on("change",function(){var i=s.subscriptionIntervalDateType.filter(":checked").val(),i=(c(t).find(".pronamic-pay-gf-subscription-interval-date-settings").hide(),c(t).find(".pronamic-pay-gf-subscription-interval-date-settings.interval-date-"+i));0<i.length&&i.show()}),s.subscriptionIntervalPeriod.on("change",function(){var i=s.subscriptionIntervalPeriod.val();switch(c(t).find(".pronamic-pay-gf-subscription-interval-date-sync-settings").hide(),c(t).find(".pronamic-pay-gf-subscription-interval-date-sync-settings.interval-"+i).show(),i){case"D":s.subscriptionIntervalDateType.filter('[value="payment_date"]').prop("checked",!0),s.subscriptionIntervalDateType.attr("disabled","disabled"),s.subscriptionIntervalDate.val(""),s.subscriptionIntervalDateDay.val(""),s.subscriptionIntervalDateMonth.val("");break;case"W":s.subscriptionIntervalDateType.removeAttr("disabled"),s.subscriptionIntervalDate.val(""),s.subscriptionIntervalDateMonth.val("");break;case"M":s.subscriptionIntervalDateType.removeAttr("disabled"),s.subscriptionIntervalDateDay.val(""),s.subscriptionIntervalDateMonth.val("");break;case"Y":s.subscriptionIntervalDateType.removeAttr("disabled"),s.subscriptionIntervalDateDay.val("")}s.subscriptionIntervalDateType.trigger("change")}),c(t).find("select.pronamic-pay-gf-subscription-interval-date-sync-settings").on("change",function(){s.subscriptionIntervalDateType.filter('[value="sync"]').prop("checked",!0),s.subscriptionIntervalDateType.trigger("change")}),s.subscriptionIntervalType.trigger("change"),s.subscriptionIntervalPeriod.trigger("change"),r=c(s.subscriptionFrequencyField),c("<option>").appendTo(r),c.each(a.getInputs(),function(i,e){var n=e.adminLabel||e.label;c("<option>").attr("value",e.id).text(n).prop("selected",o.subscriptionFrequencyField==e.id).appendTo(r)}),s.subscriptionFrequencyType.on("change",function(){var i=s.subscriptionFrequencyType.filter(":checked").val(),i=(c(t).find(".pronamic-pay-gf-subscription-frequency-settings").hide(),c(t).find(".pronamic-pay-gf-subscription-frequency-settings.frequency-"+i));0<i.length&&i.show()}),s.subscriptionFrequencyType.trigger("change"),s.subscriptionTrialEnabled.on("change",function(){var i=0<s.subscriptionTrialEnabled.filter(":checked").length,e=c(t).find(".pronamic-pay-gf-subscription-trial-settings");i?e.show():e.hide()}),s.subscriptionTrialEnabled.trigger("change"))},this.updateSelectFields=function(){p&&(s.fieldSelectFields.empty(),s.fieldSelectFields.each(function(i,e){var t=(r=c(e)).data("gateway-field-name"),e=r.data("auto-option-label");""!==e&&c("<option>").attr("value","auto").text(e).prop("selected","auto"==o.fields[t]).appendTo(r),c("<option>").appendTo(r),c.each(a.getInputs(),function(i,e){var n=e.adminLabel||e.label;c("<option>").attr("value",e.id).text(n).prop("selected",o.fields[t]==e.id).appendTo(r)})}))},this.updateFields=function(){a.updateSubscriptionFields(),a.updateSelectFields()},a.updateFields()}c.fn.gravityFormsPayFeedEditor=function(){return this.each(function(){var i,e=c(this);e.data("gf-pay-feed-editor")||(i=new n(this),e.data("gf-pay-feed-editor",i))})},c(document).ready(function(){c(".gforms_edit_form .ideal-edit-link").click(function(i){i.stopPropagation()}),c("#gf-pay-feed-editor").gravityFormsPayFeedEditor(),"undefined"!=typeof gform&&"undefined"!=typeof form&&(gform.addAction("gform_load_field_choices",function(i){var e,i=i.shift();i&&(e="pronamic_pay_payment_method_selector"===i.type,c('label[for="field_choice_values_enabled"]').parent("div").toggle(!e),e&&c.each(i.choices,function(i,e){e.builtin&&((e=c(".field-choice-input.field-choice-value").eq(i)).attr("disabled","disabled"),e.parent("li").find(".gf_delete_field_choice").remove())}))}),gform.addFilter("gform_has_conditional_logic_dependency",function(i,e){return"undefined"!=typeof form&&-1!==c.inArray(e.toString(),form.pronamic_pay_condition_field_ids)||i})),c(document).on("gform_load_field_settings",function(i,n){c.each({pronamic_pay_config_field:"pronamicPayConfigId",pronamic_pay_display_field:"pronamicPayDisplayMode"},function(i,e){i=c("#"+i);0<i.find('option[value="'+n[e]+'"]').length?i.val(n[e]):SetFieldProperty(e,"")})})})}(jQuery);
//# sourceMappingURL=admin.min.js.map