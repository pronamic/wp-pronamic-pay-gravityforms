!function(o){function n(t){var i=this,a=o(t),r={},s=(r.feed=a.find("#gf_ideal_feed"),r.gravityForm=a.find("#gf_ideal_gravity_form"),r.subscriptionAmountType=a.find('input[name="_pronamic_pay_gf_subscription_amount_type"]'),r.subscriptionAmountField=a.find("#pronamic_pay_gf_subscription_amount_field"),r.subscriptionIntervalType=a.find('input[name="_pronamic_pay_gf_subscription_interval_type"]'),r.subscriptionInterval=a.find("#pronamic_pay_gf_subscription_interval"),r.subscriptionIntervalPeriod=a.find("#pronamic_pay_gf_subscription_interval_period"),r.subscriptionIntervalDateType=a.find('input[name="_pronamic_pay_gf_subscription_interval_date_type"]'),r.subscriptionIntervalDate=a.find("#pronamic_pay_gf_subscription_interval_date"),r.subscriptionIntervalDateDay=a.find("#pronamic_pay_gf_subscription_interval_date_day"),r.subscriptionIntervalDateMonth=a.find("#pronamic_pay_gf_subscription_interval_date_month"),r.subscriptionIntervalField=a.find("#pronamic_pay_gf_subscription_interval_field"),r.subscriptionFrequencyType=a.find('input[name="_pronamic_pay_gf_subscription_frequency_type"]'),r.subscriptionNumberPeriods=a.find("#pronamic_pay_gf_subscription_number_periods"),r.subscriptionFrequencyField=a.find("#pronamic_pay_gf_subscription_frequency_field"),r.subscriptionTrialEnabled=a.find("#pronamic_pay_gf_subscription_trial_enabled"),JSON.parse(r.feed.val())),e=JSON.parse(r.gravityForm.val());this.getInputs=function(){var n=[];return e&&o.each(e.fields,function(i,e){e.inputs?o.each(e.inputs,function(i,e){n.push(e)}):e.displayOnly||n.push(e)}),n},this.updateSubscriptionFields=function(){var n;e&&(r.subscriptionAmountField.empty(),r.subscriptionIntervalField.empty(),r.subscriptionFrequencyField.empty(),n=[],e&&o.each(e.fields,function(i,e){"product"===e.type&&n.push(e)}),a=o(r.subscriptionAmountField),o("<option>").appendTo(a),o.each(n,function(i,e){var n=e.adminLabel||e.label;o("<option>").attr("value",e.id).text(n).prop("selected",s.subscriptionAmountField==e.id).appendTo(a)}),r.subscriptionAmountType.on("change",function(){var i=r.subscriptionAmountType.filter(":checked").val(),e=(o(t).find(".pronamic-pay-gf-subscription-amount-settings").hide(),""===i?r.subscriptionAmountType.parents("tr").siblings().hide():(r.subscriptionAmountType.parents("tr").siblings().show(),(e=r.subscriptionAmountType.parents("table").find("tr")).removeClass("even"),e.filter(":visible:even").addClass("even")),o(t).find(".pronamic-pay-gf-subscription-amount-settings.amount-"+i));0<e.length&&e.show()}),r.subscriptionAmountType.trigger("change"),a=o(r.subscriptionIntervalField),o("<option>").appendTo(a),o.each(i.getInputs(),function(i,e){var n=e.adminLabel||e.label;o("<option>").attr("value",e.id).text(n).prop("selected",s.subscriptionIntervalField==e.id).appendTo(a)}),r.subscriptionIntervalType.on("change",function(){var i=r.subscriptionIntervalType.filter(":checked").val(),e=(o(t).find(".pronamic-pay-gf-subscription-interval-settings").hide(),o(t).find(".pronamic-pay-gf-subscription-interval-settings.interval-"+i));"fixed"!==i&&(r.subscriptionIntervalPeriod.val("D"),r.subscriptionIntervalPeriod.trigger("change")),0<e.length&&e.show()}),r.subscriptionIntervalDateType.on("change",function(){var i=r.subscriptionIntervalDateType.filter(":checked").val(),i=(o(t).find(".pronamic-pay-gf-subscription-interval-date-settings").hide(),o(t).find(".pronamic-pay-gf-subscription-interval-date-settings.interval-date-"+i));0<i.length&&i.show()}),r.subscriptionIntervalPeriod.on("change",function(){var i=r.subscriptionIntervalPeriod.val();switch(o(t).find(".pronamic-pay-gf-subscription-interval-date-sync-settings").hide(),o(t).find(".pronamic-pay-gf-subscription-interval-date-sync-settings.interval-"+i).show(),i){case"D":r.subscriptionIntervalDateType.filter('[value="payment_date"]').prop("checked",!0),r.subscriptionIntervalDateType.attr("disabled","disabled"),r.subscriptionIntervalDate.val(""),r.subscriptionIntervalDateDay.val(""),r.subscriptionIntervalDateMonth.val("");break;case"W":r.subscriptionIntervalDateType.removeAttr("disabled"),r.subscriptionIntervalDate.val(""),r.subscriptionIntervalDateMonth.val("");break;case"M":r.subscriptionIntervalDateType.removeAttr("disabled"),r.subscriptionIntervalDateDay.val(""),r.subscriptionIntervalDateMonth.val("");break;case"Y":r.subscriptionIntervalDateType.removeAttr("disabled"),r.subscriptionIntervalDateDay.val("")}r.subscriptionIntervalDateType.trigger("change")}),o(t).find("select.pronamic-pay-gf-subscription-interval-date-sync-settings").on("change",function(){r.subscriptionIntervalDateType.filter('[value="sync"]').prop("checked",!0),r.subscriptionIntervalDateType.trigger("change")}),r.subscriptionIntervalType.trigger("change"),r.subscriptionIntervalPeriod.trigger("change"),a=o(r.subscriptionFrequencyField),o("<option>").appendTo(a),o.each(i.getInputs(),function(i,e){var n=e.adminLabel||e.label;o("<option>").attr("value",e.id).text(n).prop("selected",s.subscriptionFrequencyField==e.id).appendTo(a)}),r.subscriptionFrequencyType.on("change",function(){var i=r.subscriptionFrequencyType.filter(":checked").val(),i=(o(t).find(".pronamic-pay-gf-subscription-frequency-settings").hide(),o(t).find(".pronamic-pay-gf-subscription-frequency-settings.frequency-"+i));0<i.length&&i.show()}),r.subscriptionFrequencyType.trigger("change"),r.subscriptionTrialEnabled.on("change",function(){var i=0<r.subscriptionTrialEnabled.filter(":checked").length,e=o(t).find(".pronamic-pay-gf-subscription-trial-settings");i?e.show():e.hide()}),r.subscriptionTrialEnabled.trigger("change"))},this.updateFields=function(){i.updateSubscriptionFields()},i.updateFields()}o.fn.gravityFormsPayFeedEditor=function(){return this.each(function(){var i,e=o(this);e.data("gf-pay-feed-editor")||(i=new n(this),e.data("gf-pay-feed-editor",i))})},o(document).ready(function(){o(".gforms_edit_form .ideal-edit-link").click(function(i){i.stopPropagation()}),o("#gf-pay-feed-editor").gravityFormsPayFeedEditor(),"undefined"!=typeof gform&&"undefined"!=typeof form&&(gform.addAction("gform_load_field_choices",function(i){var e,i=i.shift();i&&(e="pronamic_pay_payment_method_selector"===i.type,o('label[for="field_choice_values_enabled"]').parent("div").toggle(!e),e&&o.each(i.choices,function(i,e){e.builtin&&((e=o(".field-choice-input.field-choice-value").eq(i)).attr("disabled","disabled"),e.parent("li").find(".gf_delete_field_choice").remove())}))}),gform.addFilter("gform_has_conditional_logic_dependency",function(i,e){return"undefined"!=typeof form&&-1!==o.inArray(e.toString(),form.pronamic_pay_condition_field_ids)||i})),o(document).on("gform_load_field_settings",function(i,n){o.each({pronamic_pay_config_field:"pronamicPayConfigId",pronamic_pay_display_field:"pronamicPayDisplayMode"},function(i,e){i=o("#"+i);0<i.find('option[value="'+n[e]+'"]').length?i.val(n[e]):SetFieldProperty(e,"")})})})}(jQuery);
//# sourceMappingURL=admin.min.js.map