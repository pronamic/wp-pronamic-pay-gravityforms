!function(p){function n(t){var a=this,r=p(t),o={},s=(o.feed=r.find("#gf_ideal_feed"),o.gravityForm=r.find("#gf_ideal_gravity_form"),o.fieldSelectFields=r.find("select.field-select"),o.subscriptionAmountType=r.find('input[name="_pronamic_pay_gf_subscription_amount_type"]'),o.subscriptionAmountField=r.find("#pronamic_pay_gf_subscription_amount_field"),o.subscriptionIntervalType=r.find('input[name="_pronamic_pay_gf_subscription_interval_type"]'),o.subscriptionInterval=r.find("#pronamic_pay_gf_subscription_interval"),o.subscriptionIntervalPeriod=r.find("#pronamic_pay_gf_subscription_interval_period"),o.subscriptionIntervalDateType=r.find('input[name="_pronamic_pay_gf_subscription_interval_date_type"]'),o.subscriptionIntervalDate=r.find("#pronamic_pay_gf_subscription_interval_date"),o.subscriptionIntervalDateDay=r.find("#pronamic_pay_gf_subscription_interval_date_day"),o.subscriptionIntervalDateMonth=r.find("#pronamic_pay_gf_subscription_interval_date_month"),o.subscriptionIntervalField=r.find("#pronamic_pay_gf_subscription_interval_field"),o.subscriptionFrequencyType=r.find('input[name="_pronamic_pay_gf_subscription_frequency_type"]'),o.subscriptionNumberPeriods=r.find("#pronamic_pay_gf_subscription_number_periods"),o.subscriptionFrequencyField=r.find("#pronamic_pay_gf_subscription_frequency_field"),o.subscriptionTrialEnabled=r.find("#pronamic_pay_gf_subscription_trial_enabled"),JSON.parse(o.feed.val())),i=JSON.parse(o.gravityForm.val());this.getInputs=function(){var n=[];return i&&p.each(i.fields,function(i,e){e.inputs?p.each(e.inputs,function(i,e){n.push(e)}):e.displayOnly||n.push(e)}),n},this.updateSubscriptionFields=function(){var n;i&&(o.subscriptionAmountField.empty(),o.subscriptionIntervalField.empty(),o.subscriptionFrequencyField.empty(),n=[],i&&p.each(i.fields,function(i,e){"product"===e.type&&n.push(e)}),r=p(o.subscriptionAmountField),p("<option>").appendTo(r),p.each(n,function(i,e){var n=e.adminLabel||e.label;p("<option>").attr("value",e.id).text(n).prop("selected",s.subscriptionAmountField==e.id).appendTo(r)}),o.subscriptionAmountType.on("change",function(){var i=o.subscriptionAmountType.filter(":checked").val(),e=(p(t).find(".pronamic-pay-gf-subscription-amount-settings").hide(),""===i?o.subscriptionAmountType.parents("tr").siblings().hide():(o.subscriptionAmountType.parents("tr").siblings().show(),(e=o.subscriptionAmountType.parents("table").find("tr")).removeClass("even"),e.filter(":visible:even").addClass("even")),p(t).find(".pronamic-pay-gf-subscription-amount-settings.amount-"+i));0<e.length&&e.show()}),o.subscriptionAmountType.trigger("change"),r=p(o.subscriptionIntervalField),p("<option>").appendTo(r),p.each(a.getInputs(),function(i,e){var n=e.adminLabel||e.label;p("<option>").attr("value",e.id).text(n).prop("selected",s.subscriptionIntervalField==e.id).appendTo(r)}),o.subscriptionIntervalType.on("change",function(){var i=o.subscriptionIntervalType.filter(":checked").val(),e=(p(t).find(".pronamic-pay-gf-subscription-interval-settings").hide(),p(t).find(".pronamic-pay-gf-subscription-interval-settings.interval-"+i));"fixed"!==i&&(o.subscriptionIntervalPeriod.val("D"),o.subscriptionIntervalPeriod.trigger("change")),0<e.length&&e.show()}),o.subscriptionIntervalDateType.on("change",function(){var i=o.subscriptionIntervalDateType.filter(":checked").val(),i=(p(t).find(".pronamic-pay-gf-subscription-interval-date-settings").hide(),p(t).find(".pronamic-pay-gf-subscription-interval-date-settings.interval-date-"+i));0<i.length&&i.show()}),o.subscriptionIntervalPeriod.on("change",function(){var i=o.subscriptionIntervalPeriod.val();switch(p(t).find(".pronamic-pay-gf-subscription-interval-date-sync-settings").hide(),p(t).find(".pronamic-pay-gf-subscription-interval-date-sync-settings.interval-"+i).show(),i){case"D":o.subscriptionIntervalDateType.filter('[value="payment_date"]').prop("checked",!0),o.subscriptionIntervalDateType.attr("disabled","disabled"),o.subscriptionIntervalDate.val(""),o.subscriptionIntervalDateDay.val(""),o.subscriptionIntervalDateMonth.val("");break;case"W":o.subscriptionIntervalDateType.removeAttr("disabled"),o.subscriptionIntervalDate.val(""),o.subscriptionIntervalDateMonth.val("");break;case"M":o.subscriptionIntervalDateType.removeAttr("disabled"),o.subscriptionIntervalDateDay.val(""),o.subscriptionIntervalDateMonth.val("");break;case"Y":o.subscriptionIntervalDateType.removeAttr("disabled"),o.subscriptionIntervalDateDay.val("")}o.subscriptionIntervalDateType.trigger("change")}),p(t).find("select.pronamic-pay-gf-subscription-interval-date-sync-settings").on("change",function(){o.subscriptionIntervalDateType.filter('[value="sync"]').prop("checked",!0),o.subscriptionIntervalDateType.trigger("change")}),o.subscriptionIntervalType.trigger("change"),o.subscriptionIntervalPeriod.trigger("change"),r=p(o.subscriptionFrequencyField),p("<option>").appendTo(r),p.each(a.getInputs(),function(i,e){var n=e.adminLabel||e.label;p("<option>").attr("value",e.id).text(n).prop("selected",s.subscriptionFrequencyField==e.id).appendTo(r)}),o.subscriptionFrequencyType.on("change",function(){var i=o.subscriptionFrequencyType.filter(":checked").val(),i=(p(t).find(".pronamic-pay-gf-subscription-frequency-settings").hide(),p(t).find(".pronamic-pay-gf-subscription-frequency-settings.frequency-"+i));0<i.length&&i.show()}),o.subscriptionFrequencyType.trigger("change"),o.subscriptionTrialEnabled.on("change",function(){var i=0<o.subscriptionTrialEnabled.filter(":checked").length,e=p(t).find(".pronamic-pay-gf-subscription-trial-settings");i?e.show():e.hide()}),o.subscriptionTrialEnabled.trigger("change"))},this.updateSelectFields=function(){i&&(o.fieldSelectFields.empty(),o.fieldSelectFields.each(function(i,e){var t=(r=p(e)).data("gateway-field-name"),e=r.data("auto-option-label");""!==e&&p("<option>").attr("value","auto").text(e).prop("selected","auto"==s.fields[t]).appendTo(r),p("<option>").appendTo(r),p.each(a.getInputs(),function(i,e){var n=e.adminLabel||e.label;p("<option>").attr("value",e.id).text(n).prop("selected",s.fields[t]==e.id).appendTo(r)})}))},this.updateFields=function(){a.updateSubscriptionFields(),a.updateSelectFields()},a.updateFields()}p.fn.gravityFormsPayFeedEditor=function(){return this.each(function(){var i,e=p(this);e.data("gf-pay-feed-editor")||(i=new n(this),e.data("gf-pay-feed-editor",i))})},p(document).ready(function(){p(".gforms_edit_form .ideal-edit-link").click(function(i){i.stopPropagation()}),p("#gf-pay-feed-editor").gravityFormsPayFeedEditor(),"undefined"!=typeof gform&&"undefined"!=typeof form&&(gform.addAction("gform_load_field_choices",function(i){var e,i=i.shift();i&&(e="pronamic_pay_payment_method_selector"===i.type,p('label[for="field_choice_values_enabled"]').parent("div").toggle(!e),e&&p.each(i.choices,function(i,e){e.builtin&&((e=p(".field-choice-input.field-choice-value").eq(i)).attr("disabled","disabled"),e.parent("li").find(".gf_delete_field_choice").remove())}))}),gform.addFilter("gform_has_conditional_logic_dependency",function(i,e){return"undefined"!=typeof form&&-1!==p.inArray(e.toString(),form.pronamic_pay_condition_field_ids)||i})),p(document).on("gform_load_field_settings",function(i,n){p.each({pronamic_pay_config_field:"pronamicPayConfigId",pronamic_pay_display_field:"pronamicPayDisplayMode"},function(i,e){i=p("#"+i);0<i.find('option[value="'+n[e]+'"]').length?i.val(n[e]):SetFieldProperty(e,"")})})})}(jQuery);
//# sourceMappingURL=admin.min.js.map